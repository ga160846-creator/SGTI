<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chamados TI</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://kit.fontawesome.com/a2d9d6a64f.js" crossorigin="anonymous"></script>
</head>
<body class="bg-gray-100 font-sans min-h-screen flex flex-col md:flex-row">

  <!-- Sidebar -->
  <div id="sidebar" class="bg-indigo-800 text-white w-64 flex flex-col fixed md:relative h-full transform -translate-x-full md:translate-x-0 transition-transform duration-300 z-50">
    <div class="p-4 flex items-center">
      <div class="w-10 h-10 rounded-full bg-indigo-600 flex items-center justify-center">
        <i class="fas fa-headset text-xl"></i>
      </div>
      <span class="ml-3 text-xl font-bold hidden md:inline">Chamados TI</span>
    </div>
    <nav class="flex-1 overflow-y-auto">
      <ul class="space-y-1 p-2">
        <li><a href="#" class="flex items-center p-3 rounded hover:bg-indigo-700" onclick="showTab('dashboard')"><i class="fas fa-home mr-3"></i> Dashboard</a></li>
        <li><a href="#" class="flex items-center p-3 rounded hover:bg-indigo-700" onclick="showTab('chamados')"><i class="fas fa-tasks mr-3"></i> Chamados</a></li>
        <li><a href="#" class="flex items-center p-3 rounded hover:bg-indigo-700" onclick="showTab('agendamento')"><i class="fas fa-calendar-check mr-3"></i> Agendamentos</a></li>
        <li><a href="#" class="flex items-center p-3 rounded hover:bg-indigo-700" onclick="showTab('equipamentos')"><i class="fas fa-desktop mr-3"></i> Equipamentos</a></li>
      </ul>
    </nav>
  </div>

  <!-- Botão Toggle Mobile -->
  <button id="toggleSidebar" class="md:hidden fixed top-4 left-4 z-50 p-3 bg-indigo-600 text-white rounded-lg shadow-lg">
    <i class="fas fa-bars"></i>
  </button>

  <!-- Main Content -->
  <div class="flex-1 p-6 overflow-y-auto md:ml-64">
    <!-- Dashboard -->
    <div id="dashboard" class="tab-content">
      <h1 class="text-2xl font-bold mb-4">Dashboard</h1>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        <div class="bg-white p-6 rounded-2xl shadow">
          <h2 class="text-xl font-semibold">Funcionários</h2>
          <p id="totalFuncionarios" class="text-3xl font-bold text-indigo-600">0</p>
        </div>
        <div class="bg-white p-6 rounded-2xl shadow">
          <h2 class="text-xl font-semibold">Equipamentos</h2>
          <p id="totalEquipamentos" class="text-3xl font-bold text-indigo-600">0</p>
        </div>
        <div class="bg-white p-6 rounded-2xl shadow">
          <h2 class="text-xl font-semibold">Agendamentos</h2>
          <p id="totalAgendamentos" class="text-3xl font-bold text-indigo-600">0</p>
        </div>
      </div>
      <p class="mt-4 text-sm text-gray-500">Última atualização: <span id="ultimaAtualizacao"></span></p>
    </div>

    <!-- Chamados -->
    <div id="chamados" class="tab-content hidden">
      <h1 class="text-2xl font-bold mb-4">Chamados</h1>
      <div id="listaChamados" class="space-y-4"></div>
    </div>

    <!-- Agendamentos -->
    <div id="agendamento" class="tab-content hidden">
      <h1 class="text-2xl font-bold mb-4">Agendamentos</h1>
      <div class="overflow-x-auto">
        <table class="w-full text-left bg-white shadow rounded min-w-[500px]">
          <thead>
            <tr class="bg-indigo-600 text-white">
              <th class="p-2">Equipamento</th>
              <th class="p-2">Data</th>
              <th class="p-2">Hora</th>
              <th class="p-2">Motivo</th>
            </tr>
          </thead>
          <tbody id="listaAgendamentos"></tbody>
        </table>
      </div>
    </div>

    <!-- Equipamentos -->
    <div id="equipamentos" class="tab-content hidden">
      <h1 class="text-2xl font-bold mb-4">Equipamentos</h1>
      <div id="listaEquipamentos" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6"></div>
    </div>
  </div>

  <!-- Script -->
  <script>
    // Sidebar toggle (mobile)
    document.getElementById("toggleSidebar").addEventListener("click", () => {
      const sidebar = document.getElementById("sidebar");
      sidebar.classList.toggle("-translate-x-full");
    });

    // Exibe aba
    function showTab(tabId) {
      document.querySelectorAll('.tab-content').forEach(tab => tab.classList.add('hidden'));
      document.getElementById(tabId).classList.remove('hidden');
      if (tabId === "dashboard") atualizarDashboard();
      if (tabId === "chamados") renderizarChamados();
      if (tabId === "agendamento") renderizarAgendamentos();
      if (tabId === "equipamentos") renderizarEquipamentos();
    }

    // Dashboard
    function atualizarDashboard() {
      const funcionarios = JSON.parse(localStorage.getItem('funcionarios')) || [];
      const equipamentos = JSON.parse(localStorage.getItem('equipamentos')) || [];
      const chamados = JSON.parse(localStorage.getItem('chamados')) || [];
      const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];

      document.getElementById("totalFuncionarios").textContent = funcionarios.length;
      document.getElementById("totalEquipamentos").textContent = equipamentos.length;
      document.getElementById("totalAgendamentos").textContent = agendamentos.length;

      document.getElementById("ultimaAtualizacao").textContent = new Date().toLocaleString();
    }

    // Chamados
    function renderizarChamados() {
      const chamados = JSON.parse(localStorage.getItem('chamados')) || [];
      const container = document.getElementById("listaChamados");
      container.innerHTML = "";
      if (chamados.length === 0) {
        container.innerHTML = "<p class='text-gray-500'>Nenhum chamado aberto.</p>";
        return;
      }
      chamados.forEach((c, i) => {
        const card = document.createElement("div");
        card.className = "bg-white p-4 rounded-xl shadow";
        card.innerHTML = `
          <h2 class="text-lg font-bold text-indigo-600">Chamado #${i+1}</h2>
          <p><b>Funcionário:</b> ${c.funcionario}</p>
          <p><b>Descrição:</b> ${c.descricao}</p>
          <p><b>Status:</b> ${c.status}</p>
        `;
        container.appendChild(card);
      });
    }

    // Agendamentos
    function renderizarAgendamentos() {
      const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
      const tbody = document.getElementById("listaAgendamentos");
      tbody.innerHTML = "";
      if (agendamentos.length === 0) {
        tbody.innerHTML = `<tr><td colspan="4" class="p-3 text-center text-gray-500">Nenhum agendamento</td></tr>`;
        return;
      }
      agendamentos.forEach(a => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td class="p-2">${a.equipamento}</td>
          <td class="p-2">${a.data}</td>
          <td class="p-2">${a.hora}</td>
          <td class="p-2">${a.motivo}</td>
        `;
        tbody.appendChild(row);
      });
    }

    // Equipamentos
    function renderizarEquipamentos() {
      const equipamentos = JSON.parse(localStorage.getItem('equipamentos')) || [];
      const container = document.getElementById("listaEquipamentos");
      container.innerHTML = "";
      if (equipamentos.length === 0) {
        container.innerHTML = "<p class='text-gray-500'>Nenhum equipamento cadastrado.</p>";
        return;
      }
      equipamentos.forEach(e => {
        const card = document.createElement("div");
        card.className = "bg-white p-4 rounded-xl shadow cursor-pointer hover:shadow-lg transition";
        card.innerHTML = `
          <h2 class="text-lg font-bold text-indigo-600">${e.nome}</h2>
          <p><b>Patrimônio:</b> ${e.patrimonio}</p>
          <p><b>Setor:</b> ${e.setor}</p>
        `;
        container.appendChild(card);
      });
    }

    // Inicializa
    document.addEventListener("DOMContentLoaded", () => {
      showTab("dashboard");
    });
  </script>
</body>
</html>


<script>
  // Sidebar toggle mobile
  document.getElementById("toggleSidebar").addEventListener("click", () => {
    document.getElementById("sidebar").classList.toggle("-translate-x-full");
  });

  /* ---- SEU SCRIPT ORIGINAL AQUI (renderização, chamados, dashboard, etc) ---- */
  // ... (mantém o JS igual ao seu, apenas adicionei o toggle do menu)

</script>
</body>
</html>


<script>
inicializarEquipamentosPadrao();

    window.addEventListener('DOMContentLoaded', () => {
  inicializarFuncionarios();
  renderizarFuncionarios(); // Certifique-se que essa função já existe e popula a lista
});

    
   window.addEventListener('DOMContentLoaded', () => {
  inicializarEquipamentos();
  renderizarEquipamentos(); // ou qualquer função que popula a tabela
});


    document.addEventListener('DOMContentLoaded', () => {
  renderizarFuncionarios();
});

// Inicializa os equipamentos padrão
function inicializarEquipamentosPadrao() {
  let equipamentos = JSON.parse(localStorage.getItem('equipamentos')) || [];

  // Se não houver equipamentos salvos, cria lista padrão
  if (equipamentos.length === 0) {
    const equipamentosPadrao = [
      { nome: 'Máquina A - 21257', tipo: 'Notebook' },
      { nome: 'Máquina B - 24976', tipo: 'Desktop' },
      { nome: 'Máquina C - 24176', tipo: 'Servidor' },
      { nome: 'Máquina D - 21796', tipo: 'Notebook' },
      { nome: 'Máquina E - 21785', tipo: 'Desktop' },
      { nome: 'Máquina F - 20149', tipo: 'Servidor' },
      { nome: 'Máquina G - 24552', tipo: 'Notebook' },
      { nome: 'Máquina H - 21456', tipo: 'Desktop' }
    ];

    // Salva no localStorage
    localStorage.setItem('equipamentos', JSON.stringify(equipamentosPadrao));
  }
}

// Renderiza a lista de equipamentos na aba
function renderizarEquipamentos() {
  const container = document.getElementById('listaEquipamentosPrincipal');
  container.innerHTML = ''; // Limpa conteúdo anterior

  const equipamentos = JSON.parse(localStorage.getItem('equipamentos')) || [];

  // Se não houver equipamentos, mostra mensagem
  if (equipamentos.length === 0) {
    container.innerHTML = '<p class="text-gray-600">Nenhum equipamento cadastrado.</p>';
    return;
  }

  // Para cada equipamento, cria o elemento HTML
  equipamentos.forEach(eq => {
    const div = document.createElement('div');
    div.className = 'p-4 bg-white rounded shadow mb-4';

    // Agora o nome já inclui o número de série
    div.innerHTML = `
      <h3 class="font-bold text-lg">${eq.nome}</h3>
      <p class="text-gray-700">Tipo: ${eq.tipo}</p>
    `;

    container.appendChild(div);
  });
}

// Chamada ao carregar a página
inicializarEquipamentosPadrao();
renderizarEquipamentos();




function carregarFuncionariosNoSelect() {
  const select = document.getElementById('nomeFuncionario');

  // Se o select não existir, evita erro
  if (!select) return;

  const funcionarios = JSON.parse(localStorage.getItem('funcionarios')) || [];

  // Limpa as opções antigas
  select.innerHTML = '<option value="" disabled selected>Selecione um funcionário</option>';

  // Adiciona cada funcionário como opção
  funcionarios.forEach(func => {
    const option = document.createElement('option');
    option.value = func.nome;
    option.textContent = func.nome;
    select.appendChild(option);
  });
}


// Chamar ao carregar a página ou ao abrir o formulário
document.addEventListener('DOMContentLoaded', carregarFuncionariosNoSelect);


function inicializarFuncionariosPadrao() {
  let funcionarios = JSON.parse(localStorage.getItem('funcionarios')) || [];

  if (funcionarios.length ===0) {
    const funcionariosPadrao = [
      { nome: 'João Silva', cargo: 'Técnico de Suporte', id: 'F001' },
      { nome: 'Maria Oliveira', cargo: 'Analista de Sistemas', id: 'F002' },
      { nome: 'Carlos Souza', cargo: 'Desenvolvedor Back-end', id: 'F003' },
      { nome: 'Ana Lima', cargo: 'Desenvolvedora Front-end', id: 'F004' },
      { nome: 'Lucas Pereira', cargo: 'Administrador de Redes', id: 'F005' },
      { nome: 'Fernanda Costa', cargo: 'Gerente de Projetos', id: 'F006' },
      { nome: 'Bruno Rocha', cargo: 'Analista de Infraestrutura', id: 'F007' },
      { nome: 'Juliana Martins', cargo: 'Especialista em Segurança', id: 'F008' }
    ];

    const faltando = funcionariosPadrao.slice(funcionarios.length);
    funcionarios.push(...faltando);
    localStorage.setItem('funcionarios', JSON.stringify(funcionarios));
  }
}



inicializarFuncionariosPadrao();

function renderizarFuncionarios() {
  const container = document.getElementById('listaFuncionarios');
  container.innerHTML = '';

  const funcionarios = JSON.parse(localStorage.getItem('funcionarios')) || [];

  if (funcionarios.length === 0) {
    container.innerHTML = '<p class="text-gray-600">Nenhum funcionário cadastrado.</p>';
    return;
  }

  funcionarios.forEach(f => {
    const div = document.createElement('div');
    div.className = 'p-4 bg-white rounded shadow mb-4';

    div.innerHTML = `
      <h3 class="font-bold text-lg">${f.nome}</h3>
      <p class="text-gray-700">${f.cargo}</p>
      <p class="text-sm text-gray-500"><strong>ID:</strong> ${f.id}</p>
    `;

    container.appendChild(div);
  });
}




/*script chamados*/ 
    let chamados = JSON.parse(localStorage.getItem('chamados')) || [];

    function salvarChamados() {
        localStorage.setItem('chamados', JSON.stringify(chamados));
    }

  function criarChamado(e) {
    e.preventDefault();

    const titulo = document.getElementById('tituloChamado').value;
    const status = document.getElementById('statusChamado').value;
    const funcao = document.getElementById('Funçãochamado').value;
    const nomeFuncionario = document.getElementById('nomeFuncionario').value; // 👈 Novo campo
const descricao = document.getElementById('descricaoChamado').value;
const equipamento = document.getElementById('patrimonioChamado').value;

chamados.push({ titulo, status, funcao, nomeFuncionario, descricao, equipamento });



    salvarChamados();
    renderizarChamados();
    e.target.reset();
}


 function renderizarChamados() {
  const lista = document.getElementById('listaChamados');
  lista.innerHTML = '';

  if (chamados.length === 0) {
    lista.innerHTML = '<li>Nenhum chamado registrado.</li>';
    return;
  }

  chamados.slice().reverse().forEach((c, index) => {
    const li = document.createElement('li');
    li.className = 'bg-gray-50 p-3 rounded border';

    const texto = document.createElement('div');
    texto.textContent = `#${chamados.length - index}: ${c.titulo} - ${c.status}`;

    const feedback = document.createElement('div');
    feedback.className = 'text-sm text-gray-600 mt-1';
    feedback.innerHTML = `<strong>Feedback:</strong> ${c.feedback || 'Nenhum'}`;

    li.appendChild(texto);
    li.appendChild(feedback);
    lista.appendChild(li);
  });
}

    /*script usuários*/
   function abrirModal(nome, cargo, id) {
  document.getElementById('modalNome').textContent = nome;
  document.getElementById('modalCargo').textContent = cargo;
  document.getElementById('modalId').textContent = id;

  document.getElementById('modalFuncionario').classList.remove('hidden');
}
    function fecharModal() {
        document.getElementById('modalFuncionario').classList.add('hidden');
    }

    /*script Equipamentos*/
     function abrirModal(nome, cargo, id) {
        document.getElementById('modalNome').textContent = nome;
        document.getElementById('modalCargo').textContent = cargo;
        document.getElementById('modalId').textContent = id;
        document.getElementById('modalFuncionario').classList.remove('hidden');
    }

    function fecharModal() {
        document.getElementById('modalFuncionario').classList.add('hidden');
    }

    function abrirModalEquip(nome, depto, id) {
        document.getElementById('equipNome').textContent = nome;
        document.getElementById('equipDepto').textContent = `Departamento: ${depto}`;
        document.getElementById('equipId').textContent = id;
        document.getElementById('modalEquipamento').classList.remove('hidden');
    }

    function fecharModalEquip() {
        document.getElementById('modalEquipamento').classList.add('hidden');
    }
    /*srcipt Agendamentos*/ 

   
    let agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];

    function salvarAgendamentos() {
        localStorage.setItem('agendamentos', JSON.stringify(agendamentos));
    }

    function agendarManutencao(e) {
        e.preventDefault();
        const equipamento = document.getElementById('equipamentoAgendamento').value;
        const data = document.getElementById('dataAgendamento').value;
        const hora = document.getElementById('horaAgendamento').value;
        const motivo = document.getElementById('motivoAgendamento').value;
        const Func = document.getElementById('Func').value;
        agendamentos.push({ equipamento, data, hora, motivo, Func });
        salvarAgendamentos();
        renderizarAgendamentos();
        e.target.reset();
    }

    function renderizarAgendamentos() {
    const lista = document.getElementById('listaAgendamentos');
    lista.innerHTML = '';

    if (agendamentos.length === 0) {
        lista.innerHTML = '<tr><td colspan="4" class="p-2 text-center">Nenhum agendamento registrado.</td></tr>';
        return;
    }

    agendamentos.forEach((a, index) => {
        const tr = document.createElement('tr');

        const tdEquip = document.createElement('td');
        tdEquip.className = 'p-2 border';
        tdEquip.textContent = a.equipamento;

        const tdData = document.createElement('td');
        tdData.className = 'p-2 border';
        tdData.textContent = a.data;

        const tdHora = document.createElement('td');
        tdHora.className = 'p-2 border';
        tdHora.textContent = a.hora;

        const tdMotivo = document.createElement('td');
        tdMotivo.className = 'p-2 border';
        tdMotivo.innerHTML = `<div>${a.motivo}</div>
            <div class="text-sm text-gray-600 mt-1"><strong>Feedback:</strong> ${a.feedback || 'Nenhum'}</div>`;

        tr.appendChild(tdEquip);
        tr.appendChild(tdData);
        tr.appendChild(tdHora);
        tr.appendChild(tdMotivo);

        lista.appendChild(tr);
    });
}



    /*script Dashboard*/ 
    
function atualizarDashboard() {
    const chamados = JSON.parse(localStorage.getItem('chamados')) || [];

    // Conta apenas chamados que não estão concluídos ou resolvidos
    const chamadosAbertos = chamados.filter(c => c.status !== 'Concluído' && c.status !== 'Resolvido');
    const totalAgendamentos = chamadosAbertos.length;

    // Conta funcionários (baseado na lista principal)
    const funcionarios = document.querySelectorAll('#listaFuncionarios > div');
    document.getElementById('totalFuncionarios').textContent = funcionarios.length;

    // Conta equipamentos (baseado na lista principal)
    const equipamentos = document.querySelectorAll('#listaEquipamentosPrincipal > div');
    document.getElementById('totalEquipamentos').textContent = equipamentos.length;

    // Total de agendamentos
    document.getElementById('totalAgendamentos').textContent = totalAgendamentos;

    // Atualiza data/hora da última atualização
    const agora = new Date();
    const dataFormatada = agora.toLocaleDateString() + ' ' + agora.toLocaleTimeString();
    document.getElementById('ultimaAtualizacao').textContent = dataFormatada;
}

// Executa no carregamento
document.addEventListener('DOMContentLoaded', atualizarDashboard);

// Exemplo: função para atualizar sempre que algo mudar
function dadosAlterados() {
    atualizarDashboard();
}

// Função para alternar abas
function showTab(tabId) {
    document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.add('hidden');
    });

    const target = document.getElementById(tabId);
    if (target) {
        target.classList.remove('hidden');
    }

    switch (tabId) {
        case 'dashboard':
            atualizarDashboard();
            break;
        case 'chamados':
            renderizarChamados();
            break;
        case 'agendamento':
            renderizarAgendamentos();
            break;
        case 'equipamentos':
            renderizarEquipamentos();
            break;
    }
}

  document.addEventListener('DOMContentLoaded', () => {
    // Mostra a aba inicial
    showTab('dashboard');

    // Inicializa todos os dados visuais
    atualizarDashboard();
    renderizarChamados();
    renderizarAgendamentos();
    // renderizarEquipamentos(); // descomente se existir
  });




// Chame essa função ao carregar a aba
document.addEventListener('DOMContentLoaded', renderizarEquipamentos);

function carregarEquipamentosNoFormulario() {
  const equipamentos = JSON.parse(localStorage.getItem('equipamentos')) || [];
  const selectEquipamento = document.getElementById('equipamentoAgendamento');

  // Limpar opções anteriores (exceto o primeiro)
  selectEquipamento.innerHTML = '<option value="">Selecione um equipamento</option>';

  equipamentos.forEach((equip) => {
    const nomeCompleto = `${equip.nome} - ${equip.numeroSerie}`;
    const option = document.createElement('option');
    option.value = nomeCompleto;
    option.textContent = nomeCompleto;
    selectEquipamento.appendChild(option);
  });
}


  // Chama ao carregar a página
  window.addEventListener('DOMContentLoaded', carregarEquipamentosNoFormulario);

  // Você pode também chamar isso sempre que a aba de agendamento for exibida, por exemplo:
  function mostrarAbaAgendamento() {
    document.querySelectorAll('.tab-content').forEach(tab => tab.classList.add('hidden'));
    document.getElementById('agendamento').classList.remove('hidden');
    carregarEquipamentosNoFormulario(); // Atualiza equipamentos
  }
  document.getElementById('enviarChamado').addEventListener('click', () => {
  const nome = document.getElementById('nomeChamado').value;
  const equipamento = document.getElementById('equipamentoChamado').value;
  const problema = document.getElementById('problemaChamado').value;
  const funcao = document.getElementById('Funçãochamado').value;

  if (!nome || !equipamento || !problema || !funcao) {
    alert("Por favor, preencha todos os campos.");
    return;
  }

  const chamado = {
    nome,
    equipamento,
    problema,
    funcao,
    data: new Date().toLocaleString()
  };

  const chamados = JSON.parse(localStorage.getItem('chamados')) || [];
  chamados.push(chamado);
  localStorage.setItem('chamados', JSON.stringify(chamados));

  alert("Chamado enviado com sucesso!");
  document.getElementById('formChamado').reset();
  atualizarChamados();
});
inicializarEquipamentosPadrao();
renderizarEquipamentos();


</script>
</body>
</html>



